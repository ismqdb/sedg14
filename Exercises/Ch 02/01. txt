See 14. 2d.c for implementation.