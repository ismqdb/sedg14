See 16. stack_pa.c for implementation.