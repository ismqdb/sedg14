See binary.c for implementation.